clear;          %Clear Workspace
close all;      %Close all figure windows
clc;            %Clear Command Window




%% Load data, here: quarterly real U.S. GDP and investment in billions of chained 2012 dollars from 1980.1 - 2018.1

gdp = [6837.641
6696.753
6688.794
6813.535
6947.042
6895.559
6978.135
6902.105
6794.878
6825.876
6799.781
6802.497
6892.144
7048.982
7189.896
7339.893
7483.371
7612.668
7686.059
7749.151
7824.247
7893.136
8013.674
8073.239
8148.603
8185.303
8263.639
8308.021
8369.930
8460.233
8533.635
8680.162
8725.006
8839.641
8891.435
9009.913
9101.508
9170.977
9238.923
9257.128
9358.289
9392.251
9398.499
9312.937
9269.367
9341.642
9388.845
9421.565
9534.346
9637.732
9732.979
9834.510
9850.973
9908.347
9955.641
10091.049
10188.954
10327.019
10387.382
10506.372
10543.644
10575.100
10665.060
10737.478
10817.896
10998.322
11096.976
11212.205
11284.587
11472.137
11615.636
11715.393
11832.486
11942.032
12091.614
12287.000
12403.293
12498.694
12662.385
12877.593
12924.179
13160.842
13178.419
13260.506
13222.690
13299.984
13244.784
13280.859
13397.002
13478.152
13538.072
13559.032
13634.253
13751.543
13985.073
14145.645
14221.147
14329.523
14464.984
14609.876
14771.602
14839.782
14972.054
15066.597
15267.026
15302.705
15326.368
15456.928
15493.328
15582.085
15666.738
15761.967
15671.383
15752.308
15667.032
15328.027
15155.940
15134.117
15189.222
15356.058
15415.145
15557.277
15671.967
15750.625
15712.754
15825.096
15820.700
16004.107
16129.418
16198.807
16220.667
16239.138
16382.964
16403.180
16531.685
16663.649
16621.696
16830.111
17033.572
17113.945
17254.744
17397.029
17438.802
17456.225
17523.374
17622.486
17706.705
17784.185
17863.023
17995.150
18120.843
18223.758
18323.963];

inv = [933.101
853.760
797.411
871.733
952.418
912.945
964.401
930.440
842.429
841.789
834.075
769.602
796.266
866.784
921.051
1010.654
1108.328
1144.371
1169.136
1153.971
1122.331
1141.447
1133.665
1175.450
1175.105
1154.589
1123.532
1126.895
1157.306
1157.909
1158.077
1236.986
1177.604
1205.662
1212.360
1230.861
1272.638
1260.328
1249.012
1239.747
1252.058
1252.449
1228.170
1159.464
1120.884
1120.880
1143.073
1183.605
1161.740
1227.440
1237.197
1274.945
1305.003
1312.511
1303.597
1372.097
1424.360
1494.411
1469.999
1530.476
1546.548
1514.426
1505.399
1542.785
1567.560
1642.882
1717.510
1715.245
1749.879
1856.956
1882.955
1911.048
1994.375
1982.058
2033.015
2095.760
2153.308
2154.652
2213.773
2273.095
2257.109
2390.733
2367.274
2371.809
2264.202
2267.433
2218.370
2108.500
2170.707
2206.375
2203.109
2201.749
2218.685
2220.283
2236.807
2253.331
2269.855
2286.379
2302.903
2319.427
2335.951
2352.475
2368.999
2385.523
2402.047
2418.571
2435.095
2451.619
2468.143
2484.667
2501.191
2517.715
2534.239
2550.763
2567.287
2583.811
2600.335
2616.859
2633.383
2649.907
2666.431
2682.955
2699.480
2716.004
2732.528
2749.052
2765.576
2782.100
2798.624
2815.148
2831.672
2848.196
2864.720
2881.244
2897.768
2914.292
2930.816
2947.340
2963.864
2980.388
2996.912
3013.436
3029.960
3046.484
3063.008
3079.532
3096.056
3112.580
3129.104
3145.628
3162.152
3178.676
3195.200];


%% Apply HP-Filter

[gdp_T, gdp_C] = hp_filter(gdp, 1600);

[inv_T, inv_C] = hp_filter(inv, 1600);





%% Plot results

dates=1980.0:0.25:2018.0;


figure;
subplot(3,1,1)
plot(dates, gdp,'k-', 'LineWidth', 2); hold on;
plot(dates, inv,'b--', 'LineWidth', 2); hold on;
title('Original Time Series')
xlabel('Years')
ylabel('Billions of dollars')
legend('GDP', 'Investment')

subplot(3,1,2)
plot(dates, gdp_T,'k-', 'LineWidth', 2); hold on;
plot(dates, inv_T,'b--', 'LineWidth', 2); hold on;
title('Trend series')
xlabel('Years')
ylabel('Billions of dollars')

subplot(3,1,3)
plot(dates, gdp_C,'k-', 'LineWidth', 2); hold on;
plot(dates, inv_C,'b--', 'LineWidth', 2); hold on;
title('Cyclical series')
xlabel('Years')
ylabel('Billions of dollars')



